import{c as oe,r as N,u as se}from"./GlobalSetup-RGbnnBT0.js";var q={exports:{}};(function(c){(function(r){var l=r.URL||r.webkitURL;function s(e){return l?l.createObjectURL(e):!1}function n(e){return l?l.revokeObjectURL(e):!1}function m(e,t){e&&e.slice(0,5)==="blob:"&&!(t&&t.noRevoke)&&n(e)}function A(e,t,i,o){if(!r.FileReader)return!1;var a=new FileReader;a.onload=function(){t.call(a,this.result)},i&&(a.onabort=a.onerror=function(){i.call(a,this.error)});var h=a[o||"readAsDataURL"];if(h)return h.call(a,e),a}function E(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}function y(e,t,i){function o(a,h){var u=document.createElement("img"),d;function g(f,S){if(a===h){a&&a(f,S);return}else if(f instanceof Error){h(f);return}S=S||{},S.image=f,a(S)}function v(f,S){S&&r.console&&console.log(S),f&&E("Blob",f)?(e=f,d=s(e)):(d=e,i&&i.crossOrigin&&(u.crossOrigin=i.crossOrigin)),u.src=d}if(u.onerror=function(f){m(d,i),h&&h.call(u,f)},u.onload=function(){m(d,i);var f={originalWidth:u.naturalWidth||u.width,originalHeight:u.naturalHeight||u.height};try{y.transform(u,i,g,e,f)}catch(S){h&&h(S)}},typeof e=="string")return y.requiresMetaData(i)?y.fetchBlob(e,v,i):v(),u;if(E("Blob",e)||E("File",e))return d=s(e),d?(u.src=d,u):A(e,function(f){u.src=f},h)}return r.Promise&&typeof t!="function"?(i=t,new Promise(o)):o(t,t)}y.requiresMetaData=function(e){return e&&e.meta},y.fetchBlob=function(e,t){t()},y.transform=function(e,t,i,o,a){i(e,a)},y.global=r,y.readFile=A,y.isInstanceOf=E,y.createObjectURL=s,y.revokeObjectURL=n,c.exports?c.exports=y:r.loadImage=y})(typeof window!="undefined"&&window||oe)})(q);var D=q.exports,j={exports:{}};(function(c){(function(r){c.exports?r(D):r(window.loadImage)})(function(r){var l=r.transform;r.createCanvas=function(s,n,m){if(m&&r.global.OffscreenCanvas)return new OffscreenCanvas(s,n);var A=document.createElement("canvas");return A.width=s,A.height=n,A},r.transform=function(s,n,m,A,E){l.call(r,r.scale(s,n,E),n,m,A,E)},r.transformCoordinates=function(){},r.getTransformedOptions=function(s,n){var m=n.aspectRatio,A,E,y,e;if(!m)return n;A={};for(E in n)Object.prototype.hasOwnProperty.call(n,E)&&(A[E]=n[E]);return A.crop=!0,y=s.naturalWidth||s.width,e=s.naturalHeight||s.height,y/e>m?(A.maxWidth=e*m,A.maxHeight=e):(A.maxWidth=y,A.maxHeight=y/m),A},r.drawImage=function(s,n,m,A,E,y,e,t,i){var o=n.getContext("2d");return i.imageSmoothingEnabled===!1?(o.msImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1):i.imageSmoothingQuality&&(o.imageSmoothingQuality=i.imageSmoothingQuality),o.drawImage(s,m,A,E,y,0,0,e,t),o},r.requiresCanvas=function(s){return s.canvas||s.crop||!!s.aspectRatio},r.scale=function(s,n,m){n=n||{},m=m||{};var A=s.getContext||r.requiresCanvas(n)&&!!r.global.HTMLCanvasElement,E=s.naturalWidth||s.width,y=s.naturalHeight||s.height,e=E,t=y,i,o,a,h,u,d,g,v,f,S,p,b;function _(){var x=Math.max((a||e)/e,(h||t)/t);x>1&&(e*=x,t*=x)}function w(){var x=Math.min((i||e)/e,(o||t)/t);x<1&&(e*=x,t*=x)}if(A&&(n=r.getTransformedOptions(s,n,m),g=n.left||0,v=n.top||0,n.sourceWidth?(u=n.sourceWidth,n.right!==void 0&&n.left===void 0&&(g=E-u-n.right)):u=E-g-(n.right||0),n.sourceHeight?(d=n.sourceHeight,n.bottom!==void 0&&n.top===void 0&&(v=y-d-n.bottom)):d=y-v-(n.bottom||0),e=u,t=d),i=n.maxWidth,o=n.maxHeight,a=n.minWidth,h=n.minHeight,A&&i&&o&&n.crop?(e=i,t=o,p=u/d-i/o,p<0?(d=o*u/i,n.top===void 0&&n.bottom===void 0&&(v=(y-d)/2)):p>0&&(u=i*d/o,n.left===void 0&&n.right===void 0&&(g=(E-u)/2))):((n.contain||n.cover)&&(a=i=i||a,h=o=o||h),n.cover?(w(),_()):(_(),w())),A){if(f=n.pixelRatio,f>1&&!(s.style.width&&Math.floor(parseFloat(s.style.width,10))===Math.floor(E/f))&&(e*=f,t*=f),r.orientationCropBug&&!s.getContext&&(g||v||u!==E||d!==y)&&(p=s,s=r.createCanvas(E,y,!0),r.drawImage(p,s,0,0,E,y,E,y,n)),S=n.downsamplingRatio,S>0&&S<1&&e<u&&t<d)for(;u*S>e;)b=r.createCanvas(u*S,d*S,!0),r.drawImage(s,b,g,v,u,d,b.width,b.height,n),g=0,v=0,u=b.width,d=b.height,s=b;return b=r.createCanvas(e,t),r.transformCoordinates(b,n,m),f>1&&(b.style.width=b.width/f+"px"),r.drawImage(s,b,g,v,u,d,e,t,n).setTransform(1,0,0,1,0,0),b}return s.width=e,s.height=t,s}})})(j);var ue=j.exports,z={exports:{}};(function(c){(function(r){c.exports?r(D):r(window.loadImage)})(function(r){var l=r.global,s=r.transform,n=l.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),m=l.ArrayBuffer&&ArrayBuffer.prototype.slice||function(t,i){i=i||this.byteLength-t;var o=new Uint8Array(this,t,i),a=new Uint8Array(i);return a.set(o),a.buffer},A={jpeg:{65505:[],65517:[]}};function E(t,i,o,a){var h=this;function u(d,g){if(!(l.DataView&&n&&t&&t.size>=12&&t.type==="image/jpeg"))return d(a);var v=o.maxMetaDataSize||262144;r.readFile(n.call(t,0,v),function(f){var S=new DataView(f);if(S.getUint16(0)!==65496)return g(new Error("Invalid JPEG file: Missing JPEG marker."));for(var p=2,b=S.byteLength-4,_=p,w,x,R,I;p<b&&(w=S.getUint16(p),w>=65504&&w<=65519||w===65534);){if(x=S.getUint16(p+2)+2,p+x>S.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if(R=A.jpeg[w],R&&!o.disableMetaDataParsers)for(I=0;I<R.length;I+=1)R[I].call(h,S,p,x,a,o);p+=x,_=p}!o.disableImageHead&&_>6&&(a.imageHead=m.call(f,0,_)),d(a)},g,"readAsArrayBuffer")||d(a)}return o=o||{},l.Promise&&typeof i!="function"?(o=i||{},a=o,new Promise(u)):(a=a||{},u(i,i))}function y(t,i,o){return!t||!i||!o?null:new Blob([o,n.call(t,i.byteLength)],{type:"image/jpeg"})}function e(t,i,o){var a={maxMetaDataSize:1024,disableMetaDataParsers:!0};if(!o&&l.Promise)return E(t,a).then(function(h){return y(t,h.imageHead,i)});E(t,function(h){o(y(t,h.imageHead,i))},a)}r.transform=function(t,i,o,a,h){r.requiresMetaData(i)?(h=h||{},E(a,function(u){u!==h&&(l.console&&console.log(u),u=h),s.call(r,t,i,o,a,u)},i,h)):s.apply(r,arguments)},r.blobSlice=n,r.bufferSlice=m,r.replaceHead=e,r.parseMetaData=E,r.metaDataParsers=A})})(z);var M=z.exports,ce={exports:{}};(function(c){(function(r){c.exports?r(D):r(window.loadImage)})(function(r){var l=r.global;l.fetch&&l.Request&&l.Response&&l.Response.prototype.blob?r.fetchBlob=function(s,n,m){function A(E){return E.blob()}if(l.Promise&&typeof n!="function")return fetch(new Request(s,n)).then(A);fetch(new Request(s,m)).then(A).then(n).catch(function(E){n(null,E)})}:l.XMLHttpRequest&&new XMLHttpRequest().responseType===""&&(r.fetchBlob=function(s,n,m){function A(E,y){m=m||{};var e=new XMLHttpRequest;e.open(m.method||"GET",s),m.headers&&Object.keys(m.headers).forEach(function(t){e.setRequestHeader(t,m.headers[t])}),e.withCredentials=m.credentials==="include",e.responseType="blob",e.onload=function(){E(e.response)},e.onerror=e.onabort=e.ontimeout=function(t){E===y?y(null,t):y(t)},e.send(m.body)}return l.Promise&&typeof n!="function"?(m=n,new Promise(A)):A(n,n)})})})(ce);var X={exports:{}};(function(c){(function(r){c.exports?r(D,M):r(window.loadImage)})(function(r){function l(e){e&&(Object.defineProperty(this,"map",{value:this.ifds[e].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[e]||{}}))}l.prototype.map={Orientation:274,Thumbnail:"ifd1",Blob:513,Exif:34665,GPSInfo:34853,Interoperability:40965},l.prototype.ifds={ifd1:{name:"Thumbnail",map:l.prototype.map},34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}},l.prototype.get=function(e){return this[e]||this[this.map[e]]};function s(e,t,i){if(i){if(t+i>e.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}return new Blob([r.bufferSlice.call(e.buffer,t,t+i)],{type:"image/jpeg"})}}var n={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}};n[7]=n[1];function m(e,t,i,o,a,h){var u=n[o],d,g,v,f,S,p;if(!u){console.log("Invalid Exif data: Invalid tag type.");return}if(d=u.size*a,g=d>4?t+e.getUint32(i+8,h):i+8,g+d>e.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(a===1)return u.getValue(e,g,h);for(v=[],f=0;f<a;f+=1)v[f]=u.getValue(e,g+f*u.size,h);if(u.ascii){for(S="",f=0;f<v.length&&(p=v[f],p!=="\0");f+=1)S+=p;return S}return v}function A(e,t,i){return(!e||e[i])&&(!t||t[i]!==!0)}function E(e,t,i,o,a,h,u,d){var g,v,f,S,p,b;if(i+6>e.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(g=e.getUint16(i,o),v=i+2+12*g,v+4>e.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(f=0;f<g;f+=1)S=i+2+12*f,p=e.getUint16(S,o),A(u,d,p)&&(b=m(e,t,S,e.getUint16(S+2,o),e.getUint32(S+4,o),o),a[p]=b,h&&(h[p]=S));return e.getUint32(v,o)}function y(e,t,i,o,a,h,u){var d=e.exif[t];d&&(e.exif[t]=new l(t),e.exifOffsets&&(e.exifOffsets[t]=new l(t)),E(i,o,o+d,a,e.exif[t],e.exifOffsets&&e.exifOffsets[t],h&&h[t],u&&u[t]))}r.parseExifData=function(e,t,i,o,a){if(!a.disableExif){var h=a.includeExifTags,u=a.excludeExifTags||{34665:{37500:!0}},d=t+10,g,v,f;if(e.getUint32(t+4)===1165519206){if(d+8>e.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(e.getUint16(t+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(e.getUint16(d)){case 18761:g=!0;break;case 19789:g=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(e.getUint16(d+2,g)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}v=e.getUint32(d+4,g),o.exif=new l,a.disableExifOffsets||(o.exifOffsets=new l,o.exifTiffOffset=d,o.exifLittleEndian=g),v=E(e,d,d+v,g,o.exif,o.exifOffsets,h,u),v&&A(h,u,"ifd1")&&(o.exif.ifd1=v,o.exifOffsets&&(o.exifOffsets.ifd1=d+v)),Object.keys(o.exif.ifds).forEach(function(S){y(o,S,e,d,g,h,u)}),f=o.exif.ifd1,f&&f[513]&&(f[513]=s(e,d+f[513],f[514]))}}},r.metaDataParsers.jpeg[65505].push(r.parseExifData),r.exifWriters={274:function(e,t,i){var o=t.exifOffsets[274];if(!o)return e;var a=new DataView(e,o+8,2);return a.setUint16(0,i,t.exifLittleEndian),e}},r.writeExifData=function(e,t,i,o){return r.exifWriters[t.exif.map[i]](e,t,o)},r.ExifMap=l})})(X);var fe=X.exports,le={exports:{}};(function(c){(function(r){c.exports?r(D,fe):r(window.loadImage)})(function(r){var l=r.ExifMap.prototype;l.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}},l.tags.ifd1=l.tags,l.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"Original",2:"Horizontal flip",3:"Rotate 180° CCW",4:"Vertical flip",5:"Vertical flip + Rotate 90° CW",6:"Rotate 90° CW",7:"Horizontal flip + Rotate 90° CW",8:"Rotate 90° CCW"}},l.getText=function(s){var n=this.get(s);switch(s){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[s][n];case"ExifVersion":case"FlashpixVersion":return n?String.fromCharCode(n[0],n[1],n[2],n[3]):void 0;case"ComponentsConfiguration":return n?this.stringValues[s][n[0]]+this.stringValues[s][n[1]]+this.stringValues[s][n[2]]+this.stringValues[s][n[3]]:void 0;case"GPSVersionID":return n?n[0]+"."+n[1]+"."+n[2]+"."+n[3]:void 0}return String(n)},l.getAll=function(){var s={},n,m,A;for(n in this)Object.prototype.hasOwnProperty.call(this,n)&&(m=this[n],m&&m.getAll?s[this.ifds[n].name]=m.getAll():(A=this.tags[n],A&&(s[A]=this.getText(A))));return s},l.getName=function(s){var n=this.tags[s];return typeof n=="object"?this.ifds[s].name:n},function(){var s=l.tags,n,m,A;for(n in s)if(Object.prototype.hasOwnProperty.call(s,n))if(m=l.ifds[n],m){A=s[n];for(n in A)Object.prototype.hasOwnProperty.call(A,n)&&(m.map[A[n]]=Number(n))}else l.map[s[n]]=Number(n)}()})})(le);var V={exports:{}};(function(c){(function(r){c.exports?r(D,M):r(window.loadImage)})(function(r){function l(){}l.prototype.map={ObjectName:5},l.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},l.prototype.get=function(e){return this[e]||this[this.map[e]]};function s(e,t,i){for(var o="",a=t+i,h=t;h<a;h+=1)o+=String.fromCharCode(e.getUint8(h));return o}function n(e,t,i,o,a){return t.types[e]==="binary"?new Blob([i.buffer.slice(o,o+a)]):t.types[e]==="Uint16"?i.getUint16(o):s(i,o,a)}function m(e,t){return e===void 0?t:e instanceof Array?(e.push(t),e):[e,t]}function A(e,t,i,o,a,h){for(var u,d,g,v=t+i,f=t;f<v;)e.getUint8(f)===28&&e.getUint8(f+1)===2&&(g=e.getUint8(f+2),(!a||a[g])&&(!h||!h[g])&&(d=e.getInt16(f+3),u=n(g,o.iptc,e,f+5,d),o.iptc[g]=m(o.iptc[g],u),o.iptcOffsets&&(o.iptcOffsets[g]=f))),f+=1}function E(e,t){return e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}function y(e,t){var i=e.getUint8(t+7);return i%2!==0&&(i+=1),i===0&&(i=4),i}r.parseIptcData=function(e,t,i,o,a){if(!a.disableIptc)for(var h=t+i;t+8<h;){if(E(e,t)){var u=y(e,t),d=t+8+u;if(d>h){console.log("Invalid IPTC data: Invalid segment offset.");break}var g=e.getUint16(t+6+u);if(t+g>h){console.log("Invalid IPTC data: Invalid segment size.");break}o.iptc=new l,a.disableIptcOffsets||(o.iptcOffsets=new l),A(e,d,g,o,a.includeIptcTags,a.excludeIptcTags||{202:!0});return}t+=1}},r.metaDataParsers.jpeg[65517].push(r.parseIptcData),r.IptcMap=l})})(V);var de=V.exports,ge={exports:{}};(function(c){(function(r){c.exports?r(D,de):r(window.loadImage)})(function(r){var l=r.IptcMap.prototype;l.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"},l.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}},l.getText=function(s){var n=this.get(s),m=this.map[s],A=this.stringValues[m];return A?A[n]:String(n)},l.getAll=function(){var s={},n,m;for(n in this)Object.prototype.hasOwnProperty.call(this,n)&&(m=this.tags[n],m&&(s[m]=this.getText(m)));return s},l.getName=function(s){return this.tags[s]},function(){var s=l.tags,n=l.map||{},m;for(m in s)Object.prototype.hasOwnProperty.call(s,m)&&(n[s[m]]=Number(m))}()})})(ge);var he={exports:{}};(function(c){(function(r){c.exports?r(D,ue,M):r(window.loadImage)})(function(r){var l=r.transform,s=r.requiresCanvas,n=r.requiresMetaData,m=r.transformCoordinates,A=r.getTransformedOptions;(function(t){if(t.global.document){var i="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k=",o=document.createElement("img");o.onload=function(){if(t.orientation=o.width===2&&o.height===3,t.orientation){var a=t.createCanvas(1,1,!0),h=a.getContext("2d");h.drawImage(o,1,1,1,1,0,0,1,1),t.orientationCropBug=h.getImageData(0,0,1,1).data.toString()!=="255,255,255,255"}},o.src=i}})(r);function E(t,i){var o=t&&t.orientation;return o===!0&&!r.orientation||o===1&&r.orientation||(!i||r.orientation)&&o>1&&o<9}function y(t,i){return t!==i&&(t===1&&i>1&&i<9||t>1&&t<9)}function e(t,i){if(i>1&&i<9)switch(t){case 2:case 4:return i>4;case 5:case 7:return i%2===0;case 6:case 8:return i===2||i===4||i===5||i===7}return!1}r.requiresCanvas=function(t){return E(t)||s.call(r,t)},r.requiresMetaData=function(t){return E(t,!0)||n.call(r,t)},r.transform=function(t,i,o,a,h){l.call(r,t,i,function(u,d){if(d){var g=r.orientation&&d.exif&&d.exif.get("Orientation");if(g>4&&g<9){var v=d.originalWidth,f=d.originalHeight;d.originalWidth=f,d.originalHeight=v}}o(u,d)},a,h)},r.getTransformedOptions=function(t,i,o){var a=A.call(r,t,i),h=o.exif&&o.exif.get("Orientation"),u=a.orientation,d=r.orientation&&h;if(u===!0&&(u=h),!y(u,d))return a;var g=a.top,v=a.right,f=a.bottom,S=a.left,p={};for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(p[b]=a[b]);if(p.orientation=u,(u>4&&!(d>4)||u<5&&d>4)&&(p.maxWidth=a.maxHeight,p.maxHeight=a.maxWidth,p.minWidth=a.minHeight,p.minHeight=a.minWidth,p.sourceWidth=a.sourceHeight,p.sourceHeight=a.sourceWidth),d>1){switch(d){case 2:v=a.left,S=a.right;break;case 3:g=a.bottom,v=a.left,f=a.top,S=a.right;break;case 4:g=a.bottom,f=a.top;break;case 5:g=a.left,v=a.bottom,f=a.right,S=a.top;break;case 6:g=a.left,v=a.top,f=a.right,S=a.bottom;break;case 7:g=a.right,v=a.top,f=a.left,S=a.bottom;break;case 8:g=a.right,v=a.bottom,f=a.left,S=a.top;break}if(e(u,d)){var _=g,w=v;g=f,v=S,f=_,S=w}}switch(p.top=g,p.right=v,p.bottom=f,p.left=S,u){case 2:p.right=S,p.left=v;break;case 3:p.top=f,p.right=S,p.bottom=g,p.left=v;break;case 4:p.top=f,p.bottom=g;break;case 5:p.top=S,p.right=f,p.bottom=v,p.left=g;break;case 6:p.top=v,p.right=f,p.bottom=S,p.left=g;break;case 7:p.top=v,p.right=g,p.bottom=S,p.left=f;break;case 8:p.top=S,p.right=g,p.bottom=v,p.left=f;break}return p},r.transformCoordinates=function(t,i,o){m.call(r,t,i,o);var a=i.orientation,h=r.orientation&&o.exif&&o.exif.get("Orientation");if(y(a,h)){var u=t.getContext("2d"),d=t.width,g=t.height,v=d,f=g;switch((a>4&&!(h>4)||a<5&&h>4)&&(t.width=g,t.height=d),a>4&&(v=g,f=d),h){case 2:u.translate(v,0),u.scale(-1,1);break;case 3:u.translate(v,f),u.rotate(Math.PI);break;case 4:u.translate(0,f),u.scale(1,-1);break;case 5:u.rotate(-.5*Math.PI),u.scale(-1,1);break;case 6:u.rotate(-.5*Math.PI),u.translate(-v,0);break;case 7:u.rotate(-.5*Math.PI),u.translate(-v,f),u.scale(1,-1);break;case 8:u.rotate(.5*Math.PI),u.translate(0,-f);break}switch(e(a,h)&&(u.translate(v,f),u.rotate(Math.PI)),a){case 2:u.translate(d,0),u.scale(-1,1);break;case 3:u.translate(d,g),u.rotate(Math.PI);break;case 4:u.translate(0,g),u.scale(1,-1);break;case 5:u.rotate(.5*Math.PI),u.scale(1,-1);break;case 6:u.rotate(.5*Math.PI),u.translate(0,-g);break;case 7:u.rotate(.5*Math.PI),u.translate(d,-g),u.scale(-1,1);break;case 8:u.rotate(-.5*Math.PI),u.translate(-d,0);break}}}})})(he);var me=D;window.loadImage=me;var pe=se,ve=N,Ae={downsample:Se};function Se(c,r,l,s,n){var m=ve.getData("/visual_search/i18n");if(!pe.includes(l,c.type)){n({metric:{name:"typekit.render.visual-search.error-message",value:{error:"format",format:c.type}},errorMessage:m.image_downsampler.file_format_not_supported});return}window.loadImage(c,function(A){if(A.type==="error"){n({metric:{name:"typekit.render.visual-search.error-message",value:{error:"unprocessable"}},errorMessage:m.image_downsampler.file_could_not_be_processed});return}var E=A.toDataURL(c.type);Ee(E)>r?n({metric:{name:"typekit.render.visual-search.error-message",value:{error:"size",size:c.size}},errorMessage:m.image_downsampler.file_is_too_large}):s(E,c.name)},{pixelRatio:1,downsamplingRatio:.5,maxWidth:4e3,maxHeight:4e3,minWidth:1,minHeight:1,canvas:!0,orientation:!0})}function Ee(c){return Math.round(c.length*3/4)}var ye=Ae,be=N,Y=null,xe="drop-file-here__link",we="visual-search-drop-zone__close",De="visual-search-file-input-drag-and-drop",F="visual-search-drag-and-drop-form",_e="drop-file-here__upload",Ce=".visual-search-drop-zone",Le="visual-search-error__text",Pe="visual-search-error__details",Re="upload-another-file-input",Ie="search-by-image-link",Be="try-a-visual-search",Z=".visual-search-file-input",Oe="#visual-search-upload-form",Te=["image/gif","image/jpeg","image/png","image/webp"],Me=5242880,H=XMLHttpRequest.DONE||4,Q=200,P;function at(){document.readyState!="loading"?G():document.addEventListener("DOMContentLoaded",G)}function G(){P=be.getData("/visual_search/i18n"),T()&&(U(T()).addEventListener("change",B),window.addEventListener("dragenter",Xe),window.addEventListener("dragleave",Ve),window.addEventListener("dragover",Ye),window.addEventListener("drop",Ke),window.addEventListener("af.search-bar.visual-search",function(){ke().addEventListener("change",B),ee()}),Fe([Ue(),We(),Ge()]),Ze(),K().addEventListener("click",Ne),W()&&W().addEventListener("change",B))}function Fe(c){var r=c.filter(function(l){return l});if(r.forEach(function(l){l.addEventListener("click",ee)}),r.length>0){const l=Qe();l&&l.addEventListener("change",B)}}function Ue(){return document.getElementById(xe)}function K(){return L().getElementsByClassName(we)[0]}function ke(){return document.getElementById(De)}function L(){return et(),document.getElementById(F)}function He(){var c=document.getElementById(F).action;return c+".json"}function Qe(){const c=document.getElementById(_e);if(c)return c.querySelector(Z)}function C(){return L().querySelector(Ce)}function J(){return document.getElementsByClassName(Le)[0]}function $(){return document.getElementsByClassName(Pe)[0]}function U(c){return c.querySelector(Z)}function Ge(){return document.getElementById(Be)}function We(){return document.getElementById(Ie)}function W(){return document.getElementById(Re)}function T(){return document.querySelector(Oe)}function Ne(){ne()}function B(c){O("typekit.click.visual-search.browse-select-image"),ie(U(c.target.form).files[0])}function ee(){U(T()).click()}function qe(c){c.metric&&O(c.metric.name,c.metric.value),c.errorMessage&&k(c.errorMessage.text,c.errorMessage.details)}function je(c,r,l){var s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===H&&s.status===Q?s.responseText.trim()?r(JSON.parse(s.responseText)):r():s.readyState===H&&s.status!==Q&&k(P.visual_search.something_went_wrong.text,P.visual_search.something_went_wrong.details)},K().addEventListener("click",function(){nt(s)}),s.open("POST",c,!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("X-CSRF-Token",ze()),s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.send(l)}function ze(){for(var c=document.getElementsByTagName("meta"),r=0;r<c.length;r++)if(c[r].getAttribute("name")=="csrf-token")return c[r].getAttribute("content")}function Xe(c){if(!(!Je(c)||!te(c))){Y=c.target;var r=C();re(L()),r.querySelector(".filename").innerText="",r.classList.remove("loading"),r.classList.add("active")}}function Ve(c){c.preventDefault(),c.target===Y&&ne()}function Ye(c){c.preventDefault(),c.stopPropagation()}function Ze(){document.body.appendChild(L())}function Ke(c){if(te(c))if(c.preventDefault(),O("typekit.click.visual-search.drop-image"),c.dataTransfer.files.length==1){var r=c.dataTransfer.files[0];C().classList.remove("active"),window.setTimeout(function(){ie(r)},1)}else c.dataTransfer.files.length>1&&k(P.visual_search.uploading_multiple_files.text,P.visual_search.uploading_multiple_files.details)}function Je(c){for(var r=c.dataTransfer,l=0;l<r.types.length;l++)if(r.types[l]==="Files")return!0;return!1}function te(c){return((c.srcElement||{}).nodeName||"").toLowerCase()!=="af-libraries-toolbar"}function re(c){c.style.display="block"}function $e(c){c.style.display="none"}function k(c,r){C().classList.remove("loading"),C().classList.add("active"),document.querySelector(".filename").innerText="",J().innerHTML=c,$().innerHTML=r}function ne(){$e(L()),ae();var c=C();c.classList.add("loading"),c.classList.remove("active"),c.querySelector(".filename").innerText=""}function et(){if(document.getElementById("drop-file-here-fullscreen")!==null){var c=document.getElementById(F).getBoundingClientRect();c.top<0||c.bottom>(window.innerHeight||document.documentElement.clientHeight)?(document.getElementById("drop-file-here-fullscreen_frame").classList.add("visual-search-fullscreen__frame"),document.getElementById("drop-file-here-fullscreen").classList.remove("drop-file-here__drop-zone"),document.getElementById("drop-file-here").classList.remove("drop-file-here__small")):(document.getElementById("drop-file-here-fullscreen_frame").classList.remove("visual-search-fullscreen__frame"),document.getElementById("drop-file-here-fullscreen").classList.add("drop-file-here__drop-zone"),document.getElementById("drop-file-here").classList.add("drop-file-here__small"))}}function tt(c,r){var l=window.URL||window.webkitURL,s=new Image;s.onload=function(){r({width:this.naturalWidth,height:this.naturalHeight,size:c.size,format:c.type})},s.src=l.createObjectURL(c)}function O(c,r){window.newrelic&&typeof window.newrelic!="undefined"&&window.newrelic.addPageAction(c,r||{})}function ie(c){ae(),rt(c),ye.downsample(c,Me,Te,function(r,l){tt(c,function(s){O("typekit.click.visual-search.upload-image",s)}),je(He(),function(s){window.location.href=s.path},JSON.stringify({image_string:r,image_file_name:l}))},qe)}function rt(c){re(L());var r=C();r.classList.add("loading"),r.querySelector(".filename").innerText=c.name}function nt(c){c.onreadystatechange=null,c.abort()}function ae(){J().innerHTML="",$().innerHTML=""}export{at as init};
//# sourceMappingURL=visual_search-dSSXZoqg.js.map
