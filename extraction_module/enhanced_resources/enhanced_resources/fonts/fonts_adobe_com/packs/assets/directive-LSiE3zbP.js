const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cropper-CHQgZH14.js","assets/GlobalSetup-RGbnnBT0.js"])))=>i.map(i=>d[i]);
var J=Object.defineProperty,Q=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var P=(r,t,o)=>t in r?J(r,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[t]=o,D=(r,t)=>{for(var o in t||(t={}))te.call(t,o)&&P(r,o,t[o]);if(F)for(var o of F(t))re.call(t,o)&&P(r,o,t[o]);return r},V=(r,t)=>Q(r,ee(t));var k=(r,t,o)=>new Promise((a,c)=>{var n=p=>{try{d(o.next(p))}catch(f){c(f)}},l=p=>{try{d(o.throw(p))}catch(f){c(f)}},d=p=>p.done?a(p.value):Promise.resolve(p.value).then(n,l);d((o=o.apply(r,t)).next())});import{k as A,l as g,m as q,z as L,D as B,o as y,ah as ie,y as oe}from"./custom-element-wk-AooBb-CRGNmWWj.js";import{Z as ae}from"./DisplayInFont-D_yecVF9.js";import{m as ne}from"./flipper-COQQihSq.js";import"./sp-switch-C-kKr_HU-lPu98kDq.js";import{a as se}from"./creative-cloud-icon-CELqJJSR-8sGZk9f3.js";import{g as U,S as ce,r as le,a as pe,u as M}from"./GlobalSetup-RGbnnBT0.js";import{_ as ue}from"./preload-helper-Toq4egZg.js";import{h as de}from"./post_login_action_creator_service-CI1YBBMx.js";const j="af.activation",z=class extends CustomEvent{constructor(t){super(j,{detail:t,bubbles:!0,composed:!0})}};z.EVENT_NAME=j;let he=z;var Ue={getImageClass:fe,getStillImageUrl:ge};function fe(r){if(r&&r.type==="gif")return"adobe-fonts-family-image-card--gif"}function ge(r){if(!r)return"";for(let t=0;t<r.length;t++)if(r[t].type!=="gif")return r[t].url_largest||r[t].url;return""}const ve=A`.browse-filter-title,.browse-filter-description{margin:4px 0}.browse-filter-image{aspect-ratio:4 / 3;width:100%}.browse-filter-link:focus-visible{outline:-webkit-focus-ring-color auto 3px;outline-offset:5px}`;var me=Object.defineProperty,ye=Object.getOwnPropertyDescriptor,_=(r,t,o,a)=>{for(var c,n=a>1?void 0:a?ye(t,o):t,l=r.length-1;l>=0;l--)(c=r[l])&&(n=(a?c(t,o,n):c(n))||n);return a&&n&&me(t,o,n),n};let v=class extends L(B){static get styles(){return ve}connectedCallback(){super.connectedCallback(),this.enableClickTracking()}render(){if(this.src)return y`<div><a class="browse-filter-link" href="${this.href}" aria-label="${this.title}"><img class="browse-filter-image" alt="${this.title}" src="${this.src}" loading="lazy"></a><h4 class="browse-filter-title">${this.title}</h4><p class="browse-filter-description"><slot name="description">${this.description}</slot></p></div>`}};_([g({type:String})],v.prototype,"description",2),_([g({type:String})],v.prototype,"href",2),_([g({type:String})],v.prototype,"src",2),_([g({type:String})],v.prototype,"title",2),v=_([q("af-browse-filter-card")],v);const _e=A`:host{--card-actions-padding: 10px 0 0 0;--card-background: var(--spectrum-global-color-gray-50);--card-border-radius: 4px;--card-box-shadow: 0 2px var(--spectrum-alias-dropshadow-blur) var(--spectrum-alias-dropshadow-color);--card-font-color: var(--spectrum-global-color-gray-900);--card-overlay-background: rgba(0, 0, 0, .7);background:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--card-box-shadow);display:inline-flex;flex-direction:column;position:relative;outline:none;overflow:hidden}:host(.linkable){cursor:pointer}::slotted(img){display:block;width:100%}.activation-switch{--spectrum-switch-m-handle-size: 24px;--spectrum-switch-m-text-size: 0;--spectrum-switch-m-track-height: 24px;--spectrum-switch-track-width: 40px;width:36px}.anchor{visibility:hidden}.overlay{background:var(--card-overlay-background);border-radius:var(--card-border-radius);bottom:0;color:var(--spectrum-global-color-static-gray-100);left:0;opacity:0;padding:15px;position:absolute;right:0;top:0;transition:opacity .5s}:host(:hover) .overlay,:host(:focus) .overlay,:host(:focus-within) .overlay{opacity:1}.overlay .actions{padding:var(--card-actions-padding);position:absolute;top:0;right:0}:host(:focus-visible),:host([selected]){border-color:var( --spectrum-card-border-color-key-focus, var(--spectrum-alias-border-color-focus));box-shadow:0 0 0 2px var( --spectrum-card-border-color-key-focus, var(--spectrum-alias-border-color-focus))}`;var be=Object.defineProperty;const Se=r=>{class t extends ie(r){get hasHref(){return!!this.href&&this.href.length>0}connectedCallback(){super.connectedCallback(),this.hasHref&&(this.classList.add("linkable"),this.setAttribute("role","link"),this.addEventListener("click",this.handleClick),this.addEventListener("keypress",this.handleKeypress))}renderLinkable(a){return y`${a} ${this.hasHref?this.renderAnchor({id:"anchor",className:"anchor",ariaHidden:!0,tabindex:-1}):""}`}handleClick(){this.anchorElement.click()}handleKeypress(a){const{code:c}=a;switch(c){case"Enter":case"Space":this.click()}}}return((o,a,c)=>{for(var n,l=void 0,d=o.length-1;d>=0;d--)(n=o[d])&&(l=n(a,c,l)||l);l&&be(a,c,l)})([oe(".anchor")],t.prototype,"anchorElement"),t},xe=A`:host{background:var(--spectrum-global-color-gray-75);border:1px solid var(--spectrum-global-color-gray-300);box-shadow:none}:host(:hover),:host(:focus){border-color:var( --spectrum-card-border-color-key-focus, var(--spectrum-alias-border-color-focus));box-shadow:0 0 0 2px var( --spectrum-card-border-color-key-focus, var(--spectrum-alias-border-color-focus))}.anchor{bottom:0;left:0;right:0;position:absolute;top:0;visibility:visible;z-index:1}.actions{z-index:2}.card-footer{align-items:center;background-color:#fafafa;border-top:1px solid var(--spectrum-global-color-gray-300);display:flex;height:60px;justify-content:center;padding:0 15px}.description{flex:1;list-style:none;margin:0;padding:0}.overlay-title,.title{font-weight:600;margin-block-end:0px;margin-block-start:0px}.subtitle,.title{color:var(--spectrum-global-color-gray-600)}.activation-button{margin-right:5px}.activation-button-content{align-items:center;display:flex;gap:5px}.overlay-subtitle,.overlay-title{color:var(--spectrum-global-color-gray-50)}`,we={"specimen-card.action.add-fonts":"Add fonts","specimen-card.action.remove-fonts":"Remove fonts","specimen-card.view-family":"View family"};var ke=Object.defineProperty,Ce=Object.getOwnPropertyDescriptor,b=(r,t,o,a)=>{for(var c,n=a>1?void 0:a?Ce(t,o):t,l=r.length-1;l>=0;l--)(c=r[l])&&(n=(a?c(t,o,n):c(n))||n);return a&&n&&ke(t,o,n),n};let m=class extends L(ae(Se(B),we)){constructor(){super(...arguments),this.activated=!1,this.footer=!1,this._openFDPAnalytics=r=>{this.sendAnalyticsEvent("specimen-fdp-open",{title:r})}}static get styles(){return[_e,xe]}connectedCallback(){super.connectedCallback(),this.addEventListener("click",()=>this._openFDPAnalytics(this.title))}render(){return this.renderLinkable(y`<div class="specimen" @click="${this._openFDPAnalytics}"><slot></slot>${this._footer()}</div>${this.renderOverlay()}`)}handleActivationSwitchChange(r){r.stopPropagation(),this.dispatchEvent(new he({isActivated:!this.activated}))}stopKeypressPropagation(r){r.stopPropagation()}handleEnterKeydown(r){if(!r.target)return;r.stopPropagation();const{code:t}=r;t==="Enter"&&r.target.click()}renderActions(){return y`<div class="actions"><sp-button class="activation-button" treatment="fill" variant="secondary" @click="${this.handleActivationSwitchChange}"><div class="activation-button-content"><sp-icon size="s">${ne(se)}</sp-icon>${this.activated?this.t("specimen-card.action.remove-fonts"):this.t("specimen-card.action.add-fonts")}</div></sp-button></div>`}renderOverlay(){if(!this.footer)return y`<div class="overlay">${this.renderActions()}<div class="overlay-title">${this.title}</div><div class="overlay-subtitle">${this.subtitle}</div></div>`}_footer(){if(this.footer)return y`<div class="card-footer"><div class="description"><div class="title">${this.title}</div><div class="subtitle">${this.subtitle}</div></div><div class="actions"><div class="subtitle">${this.t("specimen-card.view-family")}</div></div></div>`}};b([g({type:Boolean})],m.prototype,"activated",2),b([g({type:String})],m.prototype,"title",2),b([g({type:String})],m.prototype,"subtitle",2),b([g({type:Boolean})],m.prototype,"footer",2),m=b([q("af-specimen-card")],m);const $e=U(ce);var C,R;function Me(){if(R)return C;R=1,c.$inject=["$document","$scope","$window","DataService","FamilyAutocompleteSearchService","NewrelicService","NewrelicClickTrackerService"];const r=$e,t=le;var o=500,a=768;function c(n,l,d,p,f,s,e){if(this.$document=n,this.$window=d,this.DataService=p,this.FamilyAutocompleteSearchService=f,this.NewrelicService=s,this._preloadData(),d.addEventListener("resize",function(){l.$apply()}),!t.getData("project_crossbar_data")){e.init({page:"marketplace_homepage"});var i=this;d.addEventListener("beforeunload",function(){i.NewrelicService.addPageAction("typekit.marketplace_homepage.page_exit")})}}return c.prototype._webComponents_initSearchBar=function(){var n=this;const l=document.querySelector("#homepage-searchbar");l&&l.addEventListener(r.EVENT_NAME,function(p){n.FamilyAutocompleteSearchService.get(p.detail.searchParam).then(function(f){l.results=f.data})});const d=document.querySelector("#hero-searchbar");d&&d.addEventListener(r.EVENT_NAME,function(p){n.FamilyAutocompleteSearchService.get(p.detail.searchParam).then(function(f){d.results=f.data})})},c.prototype.getSmallScreenClass=function(){return this.$window.innerWidth<o?"spectrum-grid-col-xs-12":this.$window.innerWidth<a?"spectrum-grid-col-xs-6":""},c.prototype.handleSearchByImageClick=function(){this.NewrelicService.addPageAction("typekit.marketplace_homepage.search_by_image_click")},c.prototype._preloadData=function(){var n=this;n.DataService.get("/preloaded_homepage_data").then(function(l){n.browseByClassifications=l.browse_by_classifications,n.browseByLanguages=l.browse_by_languages,n.browseByTags=l.browse_by_tags}),this._webComponents_initSearchBar()},C=c,C}function Te(r,t){return k(this,null,function*(){const{default:o}=yield ue(()=>k(this,null,function*(){const{default:a}=yield import("./cropper-CHQgZH14.js").then(c=>c.c);return{default:a}}),__vite__mapDeps([0,1]));return new Promise(a=>{const c=new o(r,V(D({},t),{ready:()=>a(c)}))})})}const Ee=Object.freeze(Object.defineProperty({__proto__:null,getCropper:Te},Symbol.toStringTag,{value:"Module"})),Ae=U(Ee);var $,I;function je(){if(I)return $;I=1,s.$inject=["$document","$http","$q","$scope","$window","DataService","DialogService","FilterVariationsService","I18nService","NewrelicService","ScrollService","UserPrefsService","VisualSearchService"];var r=pe,{getCropper:t}=Ae,o=M;const a=de.default;var c=13,n="visual-searches--loading",l=/(fonts\/vs\/[^\/]*)(\/)*(.*)*/,d="text",p=["upload","select","confirm","results"],f=1e3;function s(e,i,u,x,w,S,H,K,W,G,X,Z,Y){var h=this;h.$document=e,h.$http=i,h.$q=u,h.$scope=x,h.$window=w,h.DataService=S,h.DialogService=H,h.FilterVariationsService=K,h.I18nService=W,h.NewrelicService=G,h.ScrollService=X,h.VisualSearchService=Y,h.UserPrefsService=Z,h.filterValues=[],h._init()}return s.prototype.filterFontsByRequiredActions=function(e){var i=this.FilterVariationsService.filterRequiredActionsByToggles(this.fonts,e);this.preferredAction=i.preferred,this.filteredFonts=this.FilterVariationsService.filterFontsByRequiredActions(this.fonts,i.filters)},s.prototype.showPaidFontsSelected=function(){return this.showPaidFonts},s.prototype.showTipsModal=function(){var e=this;e.DialogService.show("/angular_templates/dialogs/visual_search_tips.html",{closeOnDrag:!0}).then(function(){e.NewrelicService.addPageAction("typekit.render.visual-search.search-tips-modal")})},s.prototype.handleExampleTextKeyup=function(e){e.key==="Enter"||e.keyCode===c?this.handleNextButtonClick():(this._userEnteredText=e.target.value,this._updateExampleText(e.target.value))},s.prototype.handleNextButtonClick=function(){this.loadStep(this._getNextStep())},s.prototype.handleStartOverClick=function(){this._setCurrentStep(p[0],!0)},s.prototype.handlePreviousClick=function(){var e=p.indexOf(this._currentStep),i=p[e-1];this._setCurrentStep(i,!0)},s.prototype.fontVariationCardsClass=function(){return this.viewType==="grid"?"spectrum-grid-row font-variations-grid-view":""},s.prototype.getExampleTextValue=function(){return this._userEnteredText||this.extractedText},s.prototype.loadStep=function(e){var i=this;i._currentStep!=e&&(i._currentStep==p[1]?i._updateResultsForCoordinates().then(function(){i._setCurrentStep(e,!0),i._updateExampleText(i._userEnteredText||i.extractedText),i._scrollToTop()}):(i._setCurrentStep(e,!0),i._scrollToTop()))},s.prototype.isCurrentStep=function(e){return this._currentStep==e},s.prototype.isConfirmationImageVisible=function(){switch(this._currentStep){case p[0]:return!1;case p[1]:return!1;default:return!0}},s.prototype.isFontListEmpty=function(){return this.fonts.length===0},s.prototype.isFilteredFontListEmpty=function(){return this.filteredFonts.length===0},s.prototype.getSimilarFontCountForDisplay=function(){return this.filteredFonts.length>1?this.I18nService.getMessage(this._i18n,"neue.visual_search.results_page.similar_fonts_plural",{num_fonts:this.filteredFonts.length}):this.filteredFonts.length===1?this.I18nService.getMessage(this._i18n,"neue.visual_search.results_page.similar_font_singular",{num_fonts:1}):this.I18nService.getMessage(this._i18n,"neue.visual_search.results_page.similar_fonts_plural",{num_fonts:0})},s.prototype._getCropperCoordinates=function(){var e=this.cropper.getData();return{x_min:e.x,y_min:e.y,x_max:e.x+e.width,y_max:e.y+e.height}},s.prototype._getCropperData=function(e){if(e.coordinates&&Object.keys(e.coordinates).length!=0)return{x:e.coordinates.x_min,y:e.coordinates.y_min,width:e.coordinates.x_max-e.coordinates.x_min,height:e.coordinates.y_max-e.coordinates.y_min};if(e.detectedRegion&&Object.keys(e.detectedRegion).length!=0){var i=e.detectedRegion;return{x:i.x_min,y:i.y_min,width:i.x_max-i.x_min,height:i.y_max-i.y_min}}return{}},s.prototype._getNextStep=function(){var e=p.indexOf(this._currentStep);return e+1<p.length?p[e+1]:p[0]},s.prototype._getPlaceholderConfirmationCanvas=function(){return this.$document[0].querySelector(".visual-searches__confirm-image .visual-searches__confirmation-canvas-placeholder")},s.prototype._getStepFromUrl=function(){var e=l.exec(this.$window.location.pathname);return e[e.length-1]?e[e.length-1]:p[0]},s.prototype._getUrlForStep=function(e){var i=l.exec(this.$window.location.pathname)[1];return"/"+i+"/"+e},s.prototype._init=function(){var e=this;e.viewType="list",e._confirmationCanvas=e._getPlaceholderConfirmationCanvas(),e._preloadData().then(function(i){var u=i[1];e._currentStep!=p[0]&&e._preloadImage().then(function(){return e._initCropper(e._getCropperData(u))}).then(function(){e._showCroppedImage()})}),e.$window.onpopstate=function(){e.$scope.$apply(function(){e._setCurrentStep(e._getStepFromUrl())})}},s.prototype._initCropper=function(e){var i=this;return i._setMaxContainerDimensions(),t(i.image,{background:!1,data:e,minCropBoxHeight:10,minCropBoxWidth:10,minContainerHeight:10,minContainerWidth:10,dragMode:"none",responsive:!0,zoomable:!1,checkCrossOrigin:!1,viewMode:1}).then(u=>{i.cropper=u})},s.prototype._preloadImage=function(){var e=this;return e.$q(function(i){e.image=e.$document[0].getElementById("visual-searches__image-cropper-image"),e.$http({method:"GET",url:e.image.getAttribute("data-src"),responseType:"blob"}).then(function(u){e.image.onload=i,e.image.src=e.$window.URL.createObjectURL(u.data)})})},s.prototype._scrollToTop=function(){var e=this.$document[0].querySelector("#visual-search-heading");this.ScrollService.scrollUpTo(e,f)},s.prototype._setMaxContainerDimensions=function(){var e=this,i=e.$document[0].getElementById("visual-searches__image-cropper");i.style.maxWidth=e.image.naturalWidth+"px",i.style.maxHeight=e.image.naturalHeight+"px"},s.prototype._preloadData=function(){var e=this;return e.$q.all([e.UserPrefsService.getUserPrefs().then(function(i){e.showPaidFonts=!!i.showPaidFonts}),e.$q(function(i){e.DataService.get("/neue/preloaded_variation_data").then(function(u){e._currentStep=u.step,u.step!=p[0]&&(e.fonts=u.fonts,e.extractedText=u.detectedText,e.visualSearchOpaqueId=u.visualSearchOpaqueId,e.textSamples=u.textSampleData.textSamples,e.textSampleData=u.textSampleData),e.showUpgradeActionToggle=e.FilterVariationsService.hasUpgradeFilterOption(e.fonts),e.filterFontsByRequiredActions(),a.getSearchParam(d)&&(e._userEnteredText=decodeURIComponent(a.getSearchParam(d))),e._updateExampleText(e._userEnteredText||e.extractedText),i(u)}),e.DataService.get("/visual_search/i18n").then(function(u){e._i18n=u})})])},s.prototype._setCurrentStep=function(e,i){this._currentStep=e,this.NewrelicService.addPageAction("typekit.render.visual-search.step",{step:e}),i&&a.pushState(null,null,this._getUrlForStep(e)),e!=p[0]&&this._storeDataInUrl()},s.prototype._setLoadingState=function(){r.element(this.$document[0].body).addClass(n)},s.prototype._showCroppedImage=function(){var e=this.cropper.getCroppedCanvas();this._confirmationCanvas.parentNode.replaceChild(e,this._confirmationCanvas),this._confirmationCanvas=e},s.prototype._storeDataInUrl=function(){var e=this,i=e._getCropperCoordinates();this._userEnteredText&&(i[d]=encodeURIComponent(this._userEnteredText)),a.setSearchParams(i)},s.prototype._unsetLoadingState=function(){r.element(this.$document[0].body).removeClass(n)},s.prototype._updateExampleText=function(e){this.exampleText={size:50,value:e}},s.prototype._updateResultsForCoordinates=function(){var e=this;return e.$q(function(i){e._setLoadingState(),e.VisualSearchService.put(e.visualSearchOpaqueId,e._getCropperCoordinates()).then(function(u){e._showCroppedImage(),e.extractedText=u.data.text,e.fonts=u.data.fonts;var x={upgrade:e.showPaidFonts},w=e.FilterVariationsService.filterRequiredActionsByToggles(e.fonts,x);e.filteredFonts=e.FilterVariationsService.filterFontsByRequiredActions(e.fonts,w.filters);var S={fontCount:e.fonts.length};e.fonts.length>0&&(S.topResult=o.first(o.pluck(e.fonts,"name"))),e.NewrelicService.addPageAction("typekit.render.visual-search",S),i(),e._unsetLoadingState()})})},$=s,$}var T,N;function Fe(){if(N)return T;N=1,t.$inject=["$scope","FeedbackService","NewrelicService"];var r=M;function t(o,a,c){var n=this;n.FeedbackService=a,n.NewrelicService=c,o.$watch(function(){return n.FeedbackService.getSubmittedFeedback(n._getID(),n.familySlug())},function(l){n.selectedFeedback=l})}return t.prototype.areThumbsUpDownVisible=function(){return!this.isSimilarityAndPairingVariant()},t.prototype.isCancelButtonVisible=function(){return this.isSimilarityAndPairingVariant()},t.prototype.isSimilarityAndPairingVariant=function(){return this._isFontSimilarityVariant()||this._isFontPairingVariant()},t.prototype.initSelectedFeedback=function(){return r.isEmpty(this.selectedFeedback)?"positive":"negative"},t.prototype.toggleSelectedFeedback=function(){return this.selectedFeedback==="negative"?"positive":"negative"},t.prototype.getClass=function(o,a){return this.selectedFeedback===o?[a,"on"].join(" "):a},t.prototype.getTooltipClass=function(){return this.isCancelButtonVisible()?this.selectedFeedback==="negative"?"spectrum-Tooltip--bottom flag-icon-tooltip on":"spectrum-Tooltip--bottom flag-icon-tooltip":"spectrum-Tooltip--top"},t.prototype.handleClick=function(o,a){o&&(o.preventDefault(),o.stopPropagation()),this.selectedFeedback=a,this.isSimilarityAndPairingVariant()?(this.NewrelicService.addPageAction("typekit.browse.similarity_and_pairing.feedback",this._getNewRelicAttributes(a)),this.FeedbackService.post(this.category(),this.subcategory(),this._getID(),a,this.familySlug(),this.variationOne().id,this.variationTwo().id)):(this.NewrelicService.addPageAction("typekit.browse.click",this._getNewRelicAttributes(a)),this.FeedbackService.post(this.category(),this.subcategory(),this._getID(),a,this.familySlug()))},t.prototype._getID=function(){if(this._isTagVariant())return this.FeedbackService.filtersModel.getSelectedTag();if(this._isRecommendationVariant())return this.user();if(this.isSimilarityAndPairingVariant())return this.variationOne().id+"-"+this.variationTwo().id;throw new Error("Unrecognized feedback icon category: "+this.category())},t.prototype._isFontPairingVariant=function(){return this.category()==="pairing"},t.prototype._isFontSimilarityVariant=function(){return this.category()==="similarity"},t.prototype._isRecommendationVariant=function(){return this.category()==="recommendation"},t.prototype._isTagVariant=function(){return this.category()==="tag"},t.prototype._getNewRelicAttributes=function(o){if(this._isTagVariant())return{tagName:this.FeedbackService.filtersModel.getSelectedTag(),familySlug:this.familySlug(),feedback:o};if(this._isRecommendationVariant())return{familySlug:this.familySlug(),feedback:o,subcategory:this.subcategory(),user:this.user()};if(this.isSimilarityAndPairingVariant())return{category:this.category(),subcategory:this.subcategory(),feedback:o,variation_one:this.variationOne().name,variation_two:this.variationTwo().name};throw new Error("Unrecognized feedback icon category: "+this.category())},T=t,T}var E,O;function ze(){if(O)return E;O=1;function r(){return{scope:{},bindToController:{category:"&",familySlug:"&",subcategory:"&",tooltipText:"&",user:"&",variationOne:"&",variationTwo:"&",selectedFeedback:"="},controller:Fe(),controllerAs:"feedbackIcons",restrict:"E",replace:!0,templateUrl:"/angular_templates/directives/feedback_icons.html"}}return E=r,E}export{he as a,_e as b,je as c,ze as d,Se as e,Ue as f,$e as g,Me as r};
//# sourceMappingURL=directive-LSiE3zbP.js.map
